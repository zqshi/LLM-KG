# 审核节点接入方案架构设计

## 整体架构图

```
┌─────────────────────────────────────────────────────────────────┐
│                        业务模块层                                │
├─────────────────┬─────────────────┬─────────────────┬─────────────┤
│   内容管理模块   │  资讯聚合管理   │   Banner管理    │   其他模块   │
│  (Content Mgmt) │  (News Mgmt)    │  (Banner Mgmt)  │             │
└─────────────────┴─────────────────┴─────────────────┴─────────────┘
         │                 │                 │              │
         ▼                 ▼                 ▼              ▼
┌─────────────────────────────────────────────────────────────────┐
│                      审核节点接入层                              │
├─────────────────┬─────────────────┬─────────────────┬─────────────┤
│   内容审核节点   │   资讯审核节点   │   Banner审核节点 │   通用审核节点│
│ (Content Node)  │  (News Node)    │  (Banner Node)  │ (Generic)   │
└─────────────────┴─────────────────┴─────────────────┴─────────────┘
         │                 │                 │              │
         ▼                 ▼                 ▼              ▼
┌─────────────────────────────────────────────────────────────────┐
│                      统一审核中心                                │
├─────────────────┬─────────────────┬─────────────────┬─────────────┤
│   任务管理      │   策略配置      │   敏感词管理    │   审核员管理 │
│ (Task Mgmt)     │ (Policy Config) │ (Sensitive Words)│ (Auditor Mgmt)│
└─────────────────┴─────────────────┴─────────────────┴─────────────┘
         │                 │                 │              │
         ▼                 ▼                 ▼              ▼
┌─────────────────────────────────────────────────────────────────┐
│                        数据存储层                                │
├─────────────────┬─────────────────┬─────────────────┬─────────────┤
│   审核任务表     │   审核策略表     │   敏感词表      │   审核员表   │
│ (audit_tasks)   │ (audit_policies)│ (sensitive_words)│ (auditors)  │
└─────────────────┴─────────────────┴─────────────────┴─────────────┘
```

## 审核节点接入流程

### 1. 内容管理模块接入流程

```
内容创建/编辑 → 审核节点检查 → 提交审核任务 → 统一审核中心处理 → 回调更新状态
     │              │              │              │              │
     ▼              ▼              ▼              ▼              ▼
┌─────────┐   ┌─────────┐   ┌─────────┐   ┌─────────┐   ┌─────────┐
│ 业务逻辑 │ → │ 节点检查 │ → │ 任务提交 │ → │ 审核处理 │ → │ 状态更新 │
└─────────┘   └─────────┘   └─────────┘   └─────────┘   └─────────┘
```

### 2. 审核模式配置策略

#### 方案A：统一审核中心配置（推荐）
- **优势**：集中管理，统一标准，便于维护
- **适用场景**：审核策略相对稳定，需要统一管理
- **配置位置**：统一审核中心 → 审核策略配置

#### 方案B：各模块分别配置
- **优势**：灵活性高，模块独立性强
- **适用场景**：各模块审核需求差异较大
- **配置位置**：各业务模块内部配置

## 技术实现方案

### 1. 审核节点接口设计

```typescript
interface AuditNode {
  // 检查是否需要审核
  shouldAudit(content: any, config: AuditConfig): boolean
  
  // 提交审核任务
  submitAuditTask(content: any, config: AuditConfig): Promise<string>
  
  // 处理审核结果
  handleAuditResult(taskId: string, result: AuditResult): Promise<void>
  
  // 获取审核配置
  getAuditConfig(): AuditConfig
}
```

### 2. 审核配置接口

```typescript
interface AuditConfig {
  bizType: BizType
  mode: AuditMode  // 'pre' | 'post' | 'sample'
  sampleRate?: number
  priority: Priority
  assignRule: AssignRule
  autoApprove?: boolean
  sensitiveWordCheck?: boolean
}
```

### 3. 审核结果处理

```typescript
interface AuditResult {
  taskId: string
  status: 'approved' | 'rejected'
  reason?: string
  detail?: string
  auditorId?: number
  processTime: number
}
```

## 实施步骤

### 第一阶段：基础接入
1. 实现审核节点基类
2. 内容管理模块接入
3. 基础审核流程测试

### 第二阶段：扩展接入
1. 资讯聚合管理模块接入
2. Banner管理模块接入
3. 审核策略配置完善

### 第三阶段：优化完善
1. 性能优化
2. 监控告警
3. 数据分析

## 配置管理建议

### 推荐方案：统一审核中心配置

**理由：**
1. **集中管理**：所有审核策略在一个地方配置，便于统一管理
2. **标准化**：确保审核流程的一致性
3. **可维护性**：减少配置分散，降低维护成本
4. **扩展性**：新增业务模块时，只需接入审核节点，无需重复配置

**实现方式：**
1. 在统一审核中心配置各业务类型的审核策略
2. 各业务模块通过审核节点获取配置
3. 支持配置的动态更新和热加载
4. 提供配置的版本管理和回滚功能
